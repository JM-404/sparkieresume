<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Resume AutoFill</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <div class="app-container">
      <aside class="sidebar">
        <div class="sidebar-header">
          <h2>Resume AutoFill</h2>
        </div>
        <nav class="sidebar-nav">
          <button class="nav-item active" data-tab="quick-action" data-i18n="nav_quick_action">Quick Action</button>
          <button class="nav-item" data-tab="profile" data-i18n="nav_profile">Profile</button>
          <button class="nav-item" data-tab="chat" data-i18n="nav_chat">Chat</button>
          <button class="nav-item" data-tab="settings" data-i18n="nav_settings">Settings</button>
          <button class="nav-item" data-tab="preview" data-i18n="nav_preview">Preview</button>
          <button class="nav-item" data-tab="history" data-i18n="nav_history">History</button>
          <button class="nav-item" data-tab="help" data-i18n="nav_help">Help</button>
        </nav>
        <div class="sidebar-footer">
          <div class="lang-switch">
            <button id="langEn" class="lang-btn active">EN</button>
            <button id="langZh" class="lang-btn">中文</button>
          </div>
        </div>
      </aside>

      <main class="content">
        <!-- Quick Action Tab -->
        <section id="tab-quick-action" class="tab-content active">
          <h2 data-i18n="title_quick_action">Quick Action</h2>
          <div class="card">
            <button id="fillCurrentPageBtn" data-i18n="btn_fill_current">Fill Current Page</button>
            <p class="hint" data-i18n="hint_fill_current">Trigger autofill directly on the current tab.</p>
            <label for="autofillLanguage" data-i18n="lbl_autofill_language">Autofill value language</label>
            <select id="autofillLanguage">
              <option value="auto" data-i18n="opt_lang_auto">Auto</option>
              <option value="zh" data-i18n="opt_lang_zh">中文</option>
              <option value="en" data-i18n="opt_lang_en">English</option>
            </select>
            <div class="inline-control">
              <input id="autoMultiPage" type="checkbox" />
              <label for="autoMultiPage" data-i18n="lbl_auto_multipage">Enable multi-page auto continue</label>
            </div>
            <label for="maxAutoPages" data-i18n="lbl_max_pages">Max pages per run</label>
            <input id="maxAutoPages" type="number" min="1" max="10" value="3" />
            <ul id="fillProgressList" class="progress-list"></ul>
          </div>
        </section>

        <!-- Profile Tab -->
        <section id="tab-profile" class="tab-content">
          <h2 data-i18n="title_profile">Profile Markdown</h2>
          <div class="card">
            <input id="resumeFile" type="file" accept=".txt,.md,.pdf" />
            <p class="hint" data-i18n="hint_import">Import TXT/MD/PDF. Recommended to maintain profile.md below.</p>
            <button id="uploadBtn" data-i18n="btn_import">Import As Profile</button>

            <label for="profileMdInput">profile.md</label>
            <textarea id="profileMdInput" rows="12" placeholder="# Profile\n\n## Basic Info\n- Name: ...\n- Email: ..."></textarea>
            <button id="saveMdBtn" data-i18n="btn_save_profile">Save profile.md</button>
            <p id="status" class="status"></p>
          </div>
        </section>

        <!-- Chat Tab -->
        <section id="tab-chat" class="tab-content">
          <h2 data-i18n="title_chat">Chat With LLM</h2>
          <div class="card">
            <button id="openInterviewPageBtn" data-i18n="btn_open_interview_page">Open Interview Page</button>
            <p class="hint" data-i18n="hint_open_interview_page">
              Open a full page for interview-style chat and voice input.
            </p>
            <div id="chatBox" class="chat-box"></div>
            <textarea id="chatInput" rows="3" data-i18n-placeholder="ph_chat_input" placeholder="e.g. I recently did an internship at ByteDance, please update my project experience."></textarea>
            <button id="sendChatBtn" data-i18n="btn_send">Send</button>
          </div>
        </section>

        <!-- Settings Tab -->
        <section id="tab-settings" class="tab-content">
          <h2 data-i18n="title_settings">LLM Provider Settings</h2>
          <div class="card">
            <label for="provider" data-i18n="lbl_provider">Provider Format</label>
            <select id="provider">
              <option value="openai">OpenAI-compatible</option>
              <option value="claude">Claude (Anthropic format)</option>
              <option value="gemini">Gemini format</option>
            </select>

            <label for="baseUrl" data-i18n="lbl_base_url">Base URL</label>
            <input id="baseUrl" type="text" data-i18n-placeholder="ph_base_url" placeholder="Leave empty to use official endpoint" />

            <label for="model" data-i18n="lbl_model">Model</label>
            <input id="model" type="text" placeholder="e.g. gpt-4.1-mini / claude-3-5-sonnet-latest / gemini-1.5-flash" />

            <label for="apiKey" data-i18n="lbl_api_key">API Key</label>
            <input id="apiKey" type="password" placeholder="API key" />
            <p class="hint" data-i18n="hint_settings">You can use official endpoints or your own proxy Base URL.</p>
            <button id="saveSettingsBtn" data-i18n="btn_save_settings">Save Settings</button>
          </div>
        </section>

        <!-- Preview Tab -->
        <section id="tab-preview" class="tab-content">
          <h2 data-i18n="title_preview">Structured Preview</h2>
          <div class="card">
            <pre id="profileBox">No profile yet.</pre>
          </div>
        </section>

        <!-- History Tab -->
        <section id="tab-history" class="tab-content">
          <h2 data-i18n="title_history">History</h2>
          <div class="card">
            <ul id="historyList"></ul>
          </div>
        </section>

        <!-- Help Tab -->
        <section id="tab-help" class="tab-content">
          <h2 data-i18n="title_help">How to Use</h2>
          <div class="card help-content">
            <h3 data-i18n="help_step1_title">1. Setup Profile</h3>
            <p data-i18n="help_step1_desc">Go to the <strong>Profile</strong> tab. You can import your existing resume (PDF/TXT/MD) or manually edit the `profile.md`. This is the source of truth for autofilling.</p>
            
            <h3 data-i18n="help_step2_title">2. Configure LLM</h3>
            <p data-i18n="help_step2_desc">Go to the <strong>Settings</strong> tab. Enter your API Key and select the provider (OpenAI, Claude, etc.). This is required for the extension to understand your profile and the job application forms.</p>
            
            <h3 data-i18n="help_step3_title">3. Autofill</h3>
            <p data-i18n="help_step3_desc">Navigate to a job application page. Open this extension and go to <strong>Quick Action</strong>. Click "Fill Current Page". The extension will analyze the page and fill in the fields based on your profile.</p>
            
            <h3 data-i18n="help_step4_title">4. Chat & Update</h3>
            <p data-i18n="help_step4_desc">Use the <strong>Chat</strong> tab to update your profile using natural language. For example, "Add my new phone number 123-456-7890".</p>
          </div>
        </section>
      </main>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
